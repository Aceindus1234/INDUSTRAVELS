function flipSoundIni(){if(pSound){if(!soundManager)return pSound=!1,!1;soundManager.url="soundmanager/soundmanager2.swf",soundManager.debugMode=!1,soundManager.consoleOnly=!1,soundManager.waitForWindowLoad=!0,soundManager.onload=function(){soundManager.createSound({id:"flip",url:"flip.mp3",autoLoad:!0})}}}function ini(){if(pSound&&flipSoundIni(),document.getElementById("myBook")){allowNavigation=selectNavigation,numPixels=numPixelsToMove,numPixels>100&&(numPixels=100),pWidth=myPageW+2*pageBorderWidth,pHeight=myPageH+2*pageBorderWidth,myBook=document.getElementById("myBook"),myBook.style.width=2*pWidth+"px",myBook.style.height=pHeight+"px",myBook.style.position="relative",myBook.style.zIndex="0";for(var e=0;e<myBook.childNodes.length;e++)if(1==myBook.childNodes[e].nodeType){var t=myBook.childNodes[e],i=document.createElement("div");if(i.style.position="absolute",i.style.left=pWidth+"px",i.style.top="0px",i.style.width=pWidth+"px",i.style.height=pHeight+"px",i.style.backgroundColor="#eeeeee",i.style.overflow="hidden",i.style.zIndex=myBook.childNodes.length-counter,i.setAttribute("id","flipPage"+counter),t.parentNode.replaceChild(i,t),t.setAttribute("id","flipHtml"+counter),t.style.position="absolute",t.style.width=myPageW+"px",t.style.height=myPageH+"px",t.style.top="0px",t.style.left="0px",t.style.overflow="hidden",t.style.borderWidth=pageBorderWidth+"px",t.style.borderColor=pageBorderColor,t.style.borderStyle=pageBorderStyle,!number_check(counter))if(document.all)t.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity=100, FinishOpacity=30, Style=1, StartX=80, FinishX=100, StartY=0, FinishY=0)";else{var l=document.createElement("div");l.style.position="absolute",l.style.left=pWidth-80+"px",l.style.top="0px",l.style.width="80px",l.style.height=pHeight+"px",l.style.background="transparent url(images/e-brochures/design/black_gradient.png) top right repeat-y",t.appendChild(l)}if(allowPageClick&&(t.onclick=number_check(counter)?function(e){whichElement(e,!0)}:function(e){whichElement(e,!1)}),i.appendChild(t),allowNavigation&&document.getElementById("flipSelect")){var d=document.createElement("option");d.text=0==counter?t.getAttribute("name")?t.getAttribute("name"):"Cover ":t.getAttribute("name")?t.getAttribute("name"):counter,d.value=counter;var n=document.getElementById("flipSelect");n.style.display="",n.onchange=function(){this.blur(),document.body.focus(),autoFlip(this.value)};try{n.add(d,null)}catch(o){n.add(d)}}counter++}showBinder&&(myBinder=document.createElement("div"),myBinder.style.width=binderWidth+"px",myBinder.style.height=pHeight+"px",myBinder.style.position="absolute",myBinder.style.top="0px",myBinder.style.left=pWidth-binderWidth/2+"px",myBinder.style.background="transparent url('"+binderImage+"') top left repeat-y",myBinder.style.zIndex="200",myBook.appendChild(myBinder)),myBook.style.display=""}}function number_check(e){return 1-e%2}function autoFlip(e){if(currentLeft=leftStart-1,e>currentLeft+1)cycles=e-currentLeft,number_check(cycles)?cycles/=2:cycles=(cycles-1)/2,doIncrementalAutoFlip?(tempSound=pSound,pSound=!1,tempPixelsToMove=numPixels,tempSpeed=pSpeed,pSpeed=0,numPixels=pWidth/4,doAutoFlip(cycles,!0)):rightDirectFlip(cycles);else{if(e==currentLeft||e==currentLeft+1)return!1;cycles=currentLeft-e,number_check(cycles)?cycles/=2:cycles=(cycles+1)/2,doIncrementalAutoFlip?(tempSound=pSound,pSound=!1,tempPixelsToMove=numPixels,tempSpeed=pSpeed,pSpeed=0,numPixels=pWidth/4,doAutoFlip(cycles,!1)):leftDirectFlip(cycles)}}function doAutoFlip(e,t){return 0==e?(AF=window.clearTimeout(AF),numPixels=tempPixelsToMove,pSpeed=tempSpeed,pSound=tempSound,void 0):(t?gonext():goprev(),e--,AF=window.setTimeout("doAutoFlip("+e+","+t+")",100),void 0)}function rightDirectFlip(e){for(var t=0;e>t;t++){if(!document.getElementById("flipPage"+rightStart))return;hideDiv=document.getElementById("flipPage"+leftStart),hideHtmlDiv=document.getElementById("flipHtml"+leftStart),revealDiv=document.getElementById("flipPage"+rightStart),revealHtmlDiv=document.getElementById("flipHtml"+rightStart),revealDiv.style.left="0px",revealDiv.style.width=pWidth+"px",revealDiv.style.zIndex=0,hideDiv.style.left="",hideDiv.style.right="0px",hideDiv.style.width="0px",hideHtmlDiv.style.left="",hideHtmlDiv.style.right="0px",revealHtmlDiv.style.left="",revealHtmlDiv.style.right="0px",leftStart+=2,rightStart+=2}}function leftDirectFlip(e){for(var t=0;e>t;t++){if(!document.getElementById("flipPage"+(leftStart-2)))return!1;leftStart-=2,rightStart-=2,hideDiv=document.getElementById("flipPage"+rightStart),hideHtmlDiv=document.getElementById("flipHtml"+rightStart),revealDiv=document.getElementById("flipPage"+leftStart),revealHtmlDiv=document.getElementById("flipHtml"+leftStart),hideDiv.style.left="",hideDiv.style.right=pWidth+"px",hideDiv.style.width="0px",revealDiv.style.left=pWidth+"px",revealDiv.style.width=pWidth+"px",revealHtmlDiv.style.left="0px",hideHtmlDiv.style.left="0px"}}function gonext(){isMoving||document.getElementById("flipPage"+rightStart)&&(isMoving=!0,hideDiv=document.getElementById("flipPage"+leftStart),hideHtmlDiv=document.getElementById("flipHtml"+leftStart),revealDiv=document.getElementById("flipPage"+rightStart),revealHtmlDiv=document.getElementById("flipHtml"+rightStart),revealDiv.style.width="0px",revealDiv.style.left=2*pWidth+"px",revealDiv.style.zIndex=599,goright(2*pWidth,0))}function goright(e,t){return 2*numPixels>=e?(window.clearTimeout(ID),revealDiv.style.left="0px",revealDiv.style.width=pWidth+"px",revealDiv.style.zIndex=revealDiv.style.zIndex-599,hideHtmlDiv.style.left="",hideHtmlDiv.style.right="0px",revealHtmlDiv.style.left="",revealHtmlDiv.style.right="0px",leftStart+=2,rightStart+=2,isHidden=!1,isMoving=!1,showBinder&&(myBinder.style.zIndex="100"),allowNavigation&&document.getElementById("flipSelect")&&(document.getElementById("flipSelect").selectedIndex=leftStart-1),hasPlayed=!1,void 0):(e-=2*numPixels,t+=numPixels,revealDiv.style.left=e+"px",revealDiv.style.width=t+"px",hideWidth=e-pWidth,hideWidth>0?hideDiv.style.width=hideWidth+"px":isHidden||(hideDiv.style.width="0px",isHidden=!0),pWidth+binderWidth+numPixels>e&&!hasPlayed&&(showBinder&&(myBinder.style.zIndex="0"),pSound&&soundManager.play("flip"),hasPlayed=!0),ID=window.setTimeout("goright("+e+","+t+")",pSpeed),void 0)}function goprev(){if(!isMoving){if(!document.getElementById("flipPage"+(leftStart-2)))return!1;isMoving=!0,leftStart-=2,rightStart-=2,hideDiv=document.getElementById("flipPage"+rightStart),hideHtmlDiv=document.getElementById("flipHtml"+rightStart),revealDiv=document.getElementById("flipPage"+leftStart),revealHtmlDiv=document.getElementById("flipHtml"+leftStart),revealDiv.style.left="0px",revealDiv.style.width="0px",hideDiv.style.left="",hideDiv.style.right=pWidth+"px",goleft(0,0)}}function goleft(e,t){return e>=pWidth-2*numPixels?(window.clearTimeout(ID),revealDiv.style.left=pWidth+"px",revealDiv.style.width=pWidth+"px",revealHtmlDiv.style.left="0px",hideHtmlDiv.style.left="0px",isHidden=!1,isMoving=!1,showBinder&&(myBinder.style.zIndex="100"),allowNavigation&&document.getElementById("flipSelect")&&(document.getElementById("flipSelect").selectedIndex=leftStart-1>0?leftStart-1:leftStart),hasPlayed=!1,void 0):(e+=numPixels,t+=numPixels,revealDiv.style.width=t+"px",revealDiv.style.left=e+"px",hideWidth=pWidth-t,hideWidth>pWidth/2?hideDiv.style.width=hideWidth-numPixels+"px":isHidden||(hideDiv.style.width="0px",isHidden=!0),e>pWidth/2-numPixels&&!hasPlayed&&(showBinder&&(myBinder.style.zIndex="0"),pSound&&soundManager.play("flip"),hasPlayed=!0),ID=window.setTimeout("goleft("+e+","+t+")",pSpeed),void 0)}function whichElement(e,t){var i;if(!e)var e=window.event;return e.target?i=e.target:e.srcElement&&(i=e.srcElement),3==i.nodeType&&(i=i.parentNode),pname=i.parentNode.tagName,tname=i.tagName,"A"==tname||"INPUT"==tname||"A"==pname||"INPUT"==pname?!1:t?gonext():goprev()}function toggleBinder(){showBinder=0!=showBinder?!1:!0,myBinder.style.display=showBinder?"":"none"}function toggleSound(){pSound=0!=pSound?!1:!0}var pWidth,pHeight,isMoving=!1,myBook,isHidden=!1,AF,leftStart=0,rightStart=1,hideDiv,revealDiv,revealHtmlDiv,hideHtmlDiv,hasPlayed=!1,pSound,tempSound,soundManager,myBook,myBinder,counter=0,numPixels=20,allowNavigation=!1,tempPixelsToMove,tempSpeed,allowPageClick=!1,doIncrementalAutoFlip=!1;